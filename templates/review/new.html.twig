{% extends 'base.html.twig' %}

{% block title %}Laisser un avis - Bordeaux Gourmant{% endblock %}

{% block body %}

<section class="py-5 bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="text-center mb-5">
                    <span class="badge bg-secondary mb-3">Votre avis compte</span>
                    <h1 class="display-5 fw-bold mb-3" style="color: var(--primary);">
                        Partagez votre expérience
                    </h1>
                    <p class="lead text-muted">
                        Votre avis nous aide à nous améliorer et aide les autres clients à faire leur choix
                    </p>
                </div>

                <div class="card shadow-sm border-0">
                    <div class="card-body p-5">
                        {{ form_start(form) }}

                        <div class="mb-4">
                            {{ form_label(form.rating, null, {'label_attr': {'class': 'form-label fw-bold fs-5 mb-3'}}) }}
                            {{ form_widget(form.rating) }}
                            {{ form_errors(form.rating) }}
                        </div>

                        <div class="mb-4">
                            {{ form_label(form.comment, null, {'label_attr': {'class': 'form-label fw-bold'}}) }}
                            {{ form_widget(form.comment) }}
                            {{ form_errors(form.comment) }}
                        </div>

                        <div class="alert alert-info d-flex align-items-start">
                            <i data-feather="info" width="20" class="me-2 mt-1"></i>
                            <div>
                                <strong>Modération des avis</strong><br>
                                <small>Votre avis sera vérifié par notre équipe avant d'être publié. Cela nous permet de garantir l'authenticité et la qualité des témoignages.</small>
                            </div>
                        </div>

                        <div class="d-flex gap-3 justify-content-end">
                            <a href="{{ path('app_home') }}" class="btn btn-outline-secondary">
                                <i data-feather="x" width="18" class="me-2"></i>
                                Annuler
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i data-feather="send" width="18" class="me-2"></i>
                                Envoyer mon avis
                            </button>
                        </div>

                        {{ form_end(form) }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .rating-choice {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .rating-choice input[type="radio"] {
            display: none;
        }

        .rating-choice label {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border: 2px solid #e9ecef;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .rating-choice label:hover {
            border-color: var(--primary);
            background-color: #f8f9fa;
        }

        .rating-choice input[type="radio"]:checked + label {
            border-color: var(--primary);
            background-color: rgba(var(--primary-rgb), 0.1);
            font-weight: bold;
        }

        .rating-choice label .rating-stars {
            display: flex;
            gap: 0.125rem;
            margin-right: 0.75rem;
        }

        .rating-choice label .star-filled {
            color: #ffc107;
            fill: #ffc107;
            stroke: #f59e0b;
            stroke-width: 1.5;
        }

        .rating-choice label .star-empty {
            color: #e5e7eb;
            fill: #f3f4f6;
            stroke: #d1d5db;
            stroke-width: 1.5;
        }
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add stars to each rating label
            const labels = document.querySelectorAll('.rating-choice label');
            labels.forEach((label, index) => {
                const rating = index + 1;
                const starsContainer = document.createElement('div');
                starsContainer.className = 'rating-stars';

                for (let i = 1; i <= 5; i++) {
                    const star = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    star.setAttribute('width', '18');
                    star.setAttribute('height', '18');
                    star.setAttribute('viewBox', '0 0 24 24');
                    star.setAttribute('fill', 'none');
                    star.setAttribute('stroke', 'currentColor');
                    star.setAttribute('stroke-width', '2');
                    star.setAttribute('stroke-linecap', 'round');
                    star.setAttribute('stroke-linejoin', 'round');
                    star.classList.add(i <= rating ? 'star-filled' : 'star-empty');

                    const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                    polygon.setAttribute('points', '12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2');

                    star.appendChild(polygon);
                    starsContainer.appendChild(star);
                }

                label.insertBefore(starsContainer, label.firstChild);
            });
        });
    </script>
{% endblock %}